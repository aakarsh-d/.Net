Sales Data (Intentionally Poor Design)

Scenario

A small retail company stores sales data in one single table. The design was done by a non-technical staff member who wanted “everything in one place”.
Your task is to analyze, query, and improve this design.

1️⃣ Immature (Unnormalized) Table Design

Table: Sales_Raw

CREATE TABLE Sales_Raw

(

    OrderID INT,

    OrderDate VARCHAR(20),

    CustomerName VARCHAR(100),

    CustomerPhone VARCHAR(20),

    CustomerCity VARCHAR(50),

    ProductNames VARCHAR(200),   -- Multiple products comma-separated

    Quantities VARCHAR(100),     -- Multiple quantities comma-separated

    UnitPrices VARCHAR(100),     -- Multiple prices comma-separated

    SalesPerson VARCHAR(100)

);

Sample Data

INSERT INTO Sales_Raw VALUES

(101, '2024-01-05', 'Ravi Kumar', '9876543210', 'Chennai',

 'Laptop,Mouse', '1,2', '55000,500', 'Anitha'),

 

(102, '2024-01-06', 'Priya Sharma', '9123456789', 'Bangalore',

 'Keyboard,Mouse', '1,1', '1500,500', 'Anitha'),

 

(103, '2024-01-10', 'Ravi Kumar', '9876543210', 'Chennai',

 'Laptop', '1', '54000', 'Suresh'),

 

(104, '2024-02-01', 'John Peter', '9988776655', 'Hyderabad',

 'Monitor,Mouse', '1,1', '12000,500', 'Anitha'),

 

(105, '2024-02-10', 'Priya Sharma', '9123456789', 'Bangalore',

 'Laptop,Keyboard', '1,1', '56000,1500', 'Suresh');

2️⃣ Assignment Questions

Question 1 – Normalization (Design Thinking)

The Sales_Raw table violates normalization rules.

Tasks:

    Identify at least three normalization problems
    Redesign the database into proper normalized tables (minimum 3NF)
    Write CREATE TABLE statements for the new design

(No data migration required, only structure)

Question 2 – Third Highest Total Sales (Analytical Query)

Each order may contain multiple products.

Task:
Write a SQL query to find the third highest total sales amount, where:

Total Sales = Quantity × Unit Price (for all products in an order)

Hint: You may need STRING_SPLIT, CROSS APPLY, or window functions.

Question 3 – GROUP BY & HAVING (Business Rule)

Management wants to identify salespersons who generated high revenue.

Task:
Write a query to list SalesPerson names whose total sales amount is greater than ₹60,000.

Use:

    GROUP BY
    HAVING

Question 4 – Subquery Usage

The company wants to find customers who spent more than the average customer spending.

Task:
Write a query using a subquery to display:

    CustomerName
    Total amount spent

Only include customers whose total spending is above the average spending of all customers.

Question 5 – String & Date Functions

Operations team wants formatted and filtered data.

Tasks:

    Display CustomerName in UPPERCASE
    Extract Order Month from OrderDate
    Show only orders placed in January 2026